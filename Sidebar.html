<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <?!= include('Styles') ?>
</head>
<body>
  <div class="header">
    <h3>âš¡ <span data-i18n="title">Fast QR Generator</span></h3>
    <button class="lang-toggle" onclick="toggleLanguage()">Ø¹</button>
  </div>
  
  <div class="kofi-box">
    <a href="https://ko-fi.com/asimnet" target="_blank">
      â˜• <span data-i18n="kofi">Buy me a coffee!</span>
    </a>
  </div>
  
  <div class="info-box" id="infoBox">
    <!-- Will be filled by applyLanguage() -->
  </div>
  
  <div id="formContainer">
    <div class="section">
      <div class="section-title">
        <span>ğŸ“‘ <span data-i18n="selectSheets">Select Sheets</span></span>
        <button class="btn-refresh" id="refreshBtn" onclick="refreshColumns()" title="Refresh columns">
          <span class="refresh-icon">ğŸ”„</span>
          <span data-i18n="refresh">Refresh</span>
        </button>
      </div>
      <div class="select-btns">
        <button onclick="selectAll()" data-i18n="selectAll">Select All</button>
        <button onclick="deselectAll()" data-i18n="deselectAll">Deselect All</button>
      </div>
      <div class="sheet-list" id="sheetList">
        <div style="padding:10px;color:#666" data-i18n="loading">Loading...</div>
      </div>
    </div>
    
    <div class="section">
      <div class="section-title">âš™ï¸ <span data-i18n="settings">Settings</span></div>
      <div class="form-group">
        <label data-i18n="qrSize">QR Code Size (pixels)</label>
        <input type="number" id="qrSize" value="150" min="80" max="400">
      </div>
    </div>
    
    <button class="btn btn-primary" onclick="startGeneration()" id="startBtn">
      âš¡ <span data-i18n="generate">Start Generation</span>
    </button>
  </div>
  
  <div class="progress-container" id="progressContainer">
    <div class="section">
      <!-- Phase 1: Generation -->
      <div id="phase1">
        <div class="phase-label">ğŸ”„ <span data-i18n="phase1">Phase 1: Generate QR Codes</span></div>
        <div class="progress-bar">
          <div class="progress-fill gen" id="genFill" style="width:0%">0%</div>
        </div>
      </div>
      
      <!-- Phase 2: Saving -->
      <div id="phase2" style="display:none">
        <div class="phase-label">ğŸ’¾ <span data-i18n="phase2">Phase 2: Save to Sheet</span></div>
        <div class="progress-bar">
          <div class="progress-fill save" id="saveFill" style="width:0%">0%</div>
        </div>
      </div>
      
      <div class="stats">
        <div class="stat-item">
          <div class="stat-value" id="statCount">0</div>
          <div class="stat-label" id="statCountLabel" data-i18n="generated">Generated</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="statSpeed">0</div>
          <div class="stat-label" data-i18n="perSecond">/sec</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="statTime">0s</div>
          <div class="stat-label" data-i18n="elapsed">Time</div>
        </div>
      </div>
      
      <div class="sheet-status" id="sheetStatus"></div>
      <button class="btn btn-stop" onclick="stopGeneration()" id="stopBtn">
        â¹ï¸ <span data-i18n="stop">Stop</span>
      </button>
    </div>
  </div>
  
  <div class="result" id="result"></div>
  <div class="footer">Made with â¤ï¸ by <a href="https://ko-fi.com/asimnet" target="_blank">Asim</a></div>
  <canvas id="qrCanvas"></canvas>

  <?!= include('QRLib') ?>
  <?!= include('App') ?>
</body>
</html>
